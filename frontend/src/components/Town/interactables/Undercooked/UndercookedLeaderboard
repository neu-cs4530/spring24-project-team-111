import { Table, Tbody, Td, Thead, Tr } from '@chakra-ui/react';
import React from 'react';
import { GameResult, UndercookedGameState } from '../../../types/CoveyTownSocket';

export default function UndercookedLeaderboard(endingGame: UndercookedGameState): JSX.Element {
    const winsLossesTiesByPlayer: Record<
      string,
      { player1: string; player2: number; score: number }
    > = {};

    // checking if 5 games are not up
    if (Object.keys(winsLossesTiesByPlayer).length != 5) {
    winsLossesTiesByPlayer[endingGame.instanceID] = {
        player1: endingGame.player1,
        player2: endingGame.player2,
        score: endingGame.score
    };
} // check if the game is greater than the current games up 
else {
    for (const key in winsLossesTiesByPlayer) {
        if (winsLossesTiesByPlayer[key].score < endingGame.score) {
            delete winsLossesTiesByPlayer[key];
            winsLossesTiesByPlayer[endingGame.instanceID] = {
                player1: endingGame.player1,
        player2: endingGame.player2,
        score: endingGame.score
            };
        }
    }
}

    const rows = Object.keys(winsLossesTiesByPlayer).map(player => winsLossesTiesByPlayer[player]);
    rows.sort((a, b) => b.score - a.scpre);
    return (
        <Table>
          <Thead>
            <Tr>
              <th>Player1</th>
              <th>Player2</th>
              <th>Score</th>
            </Tr>
          </Thead>
          <Tbody>
            {rows.map(record => {
              return (
                <Tr key={record.player}>
                  <Td>{record.player}</Td>
                  <Td>{record.wins}</Td>
                  <Td>{record.losses}</Td>
                  <Td>{record.ties}</Td>
                </Tr>
              );
            })}
          </Tbody>
        </Table>
      );
    }
    